<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Admin Dashboard - North Cafe</title>
    <link rel="stylesheet" href="output.css">
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Inter:ital,opsz,wght@0,14..32,100..900;1,14..32,100..900&display=swap');
        @import url('https://fonts.googleapis.com/css2?family=Dancing+Script:wght@400..700&display=swap');
    </style>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/all.min.css">
</head>
<body class="bg-gray-100">
    <!-- Header -->
    <header class="fixed top-0 left-0 right-0 z-50 bg-white px-[64px] py-[32px] flex justify-between items-center shadow-md">
        <nav>
            <a href="index.html" class="text-[#B20201] font-[700] text-[36px] leading-[44px] dancing-script">
                North Café Admin
            </a>
        </nav>
        <nav class="flex gap-[24px] items-center">
            <button onclick="logout()" class="text-[#B20201] text-[20px] font-[700]">Logout</button>
        </nav>
    </header>

    <!-- Main Content -->
    <main class="pt-[160px] px-[64px]">
        <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-[32px]">
            <!-- Meals Management -->
            <div class="bg-white p-[32px] rounded-[12px] shadow-md">
                <h2 class="text-[24px] font-bold mb-[24px]">Manage Meals</h2>
                <form id="mealForm" class="space-y-[16px]">
                    <div>
                        <label class="block text-[16px] mb-[8px]">Name</label>
                        <input type="text" id="mealName" class="w-full p-[12px] border rounded-[8px]" required>
                    </div>
                    <div>
                        <label class="block text-[16px] mb-[8px]">Description</label>
                        <textarea id="mealDescription" class="w-full p-[12px] border rounded-[8px]" required></textarea>
                    </div>
                    <div>
                        <label class="block text-[16px] mb-[8px]">Price (₦)</label>
                        <input type="number" id="mealPrice" class="w-full p-[12px] border rounded-[8px]" required>
                    </div>
                    <div>
                        <label class="block text-[16px] mb-[8px]">Image URL</label>
                        <input type="url" id="mealImage" class="w-full p-[12px] border rounded-[8px]" required>
                    </div>
                    <button type="submit" class="w-full bg-[#B20201] text-white p-[12px] rounded-[8px] font-bold">Add Meal</button>
                </form>
                <div id="mealsList" class="mt-[24px] space-y-[16px]">
                    <!-- Meals will be listed here -->
                </div>
            </div>

            <!-- Delivery Types Management -->
            <div class="bg-white p-[32px] rounded-[12px] shadow-md">
                <h2 class="text-[24px] font-bold mb-[24px]">Manage Delivery Types</h2>
                <form id="deliveryTypeForm" class="space-y-[16px]">
                    <div>
                        <label class="block text-[16px] mb-[8px]">Name</label>
                        <input type="text" id="deliveryTypeName" class="w-full p-[12px] border rounded-[8px]" required>
                    </div>
                    <div>
                        <label class="block text-[16px] mb-[8px]">Price (₦)</label>
                        <input type="number" id="deliveryTypePrice" class="w-full p-[12px] border rounded-[8px]" required>
                    </div>
                    <button type="submit" class="w-full bg-[#B20201] text-white p-[12px] rounded-[8px] font-bold">Add Delivery Type</button>
                </form>
                <div id="deliveryTypesList" class="mt-[24px] space-y-[16px]">
                    <!-- Delivery types will be listed here -->
                </div>
            </div>

            <!-- Locations Management -->
            <div class="bg-white p-[32px] rounded-[12px] shadow-md">
                <h2 class="text-[24px] font-bold mb-[24px]">Manage Locations</h2>
                <form id="locationForm" class="space-y-[16px]">
                    <div>
                        <label class="block text-[16px] mb-[8px]">Name</label>
                        <input type="text" id="locationName" class="w-full p-[12px] border rounded-[8px]" required>
                    </div>
                    <button type="submit" class="w-full bg-[#B20201] text-white p-[12px] rounded-[8px] font-bold">Add Location</button>
                </form>
                <div id="locationsList" class="mt-[24px] space-y-[16px]">
                    <!-- Locations will be listed here -->
                </div>
            </div>
        </div>
    </main>

    <script>
        // Fetch and display meals
        async function fetchMeals() {
            const response = await fetch('http://localhost:8000/api/meals/');
            const meals = await response.json();
            const container = document.getElementById('mealsList');
            
            container.innerHTML = meals.map(meal => `
                <div class="border p-[16px] rounded-[8px]">
                    <h3 class="font-bold">${meal.name}</h3>
                    <p class="text-gray-600">${meal.description}</p>
                    <p class="font-bold">₦${meal.price}</p>
                    <div class="mt-[8px] flex gap-[8px]">
                        <button onclick="editMeal(${meal.id})" class="text-blue-600">Edit</button>
                        <button onclick="deleteMeal(${meal.id})" class="text-red-600">Delete</button>
                    </div>
                </div>
            `).join('');
        }

        // Fetch and display delivery types
        async function fetchDeliveryTypes() {
            const response = await fetch('http://localhost:8000/api/delivery-types/');
            const types = await response.json();
            const container = document.getElementById('deliveryTypesList');
            
            container.innerHTML = types.map(type => `
                <div class="border p-[16px] rounded-[8px]">
                    <h3 class="font-bold">${type.name}</h3>
                    <p class="font-bold">₦${type.price}</p>
                    <div class="mt-[8px] flex gap-[8px]">
                        <button onclick="editDeliveryType(${type.id})" class="text-blue-600">Edit</button>
                        <button onclick="deleteDeliveryType(${type.id})" class="text-red-600">Delete</button>
                    </div>
                </div>
            `).join('');
        }

        // Fetch and display locations
        async function fetchLocations() {
            const response = await fetch('http://localhost:8000/api/locations/');
            const locations = await response.json();
            const container = document.getElementById('locationsList');
            
            container.innerHTML = locations.map(location => `
                <div class="border p-[16px] rounded-[8px]">
                    <h3 class="font-bold">${location.name}</h3>
                    <div class="mt-[8px] flex gap-[8px]">
                        <button onclick="editLocation(${location.id})" class="text-blue-600">Edit</button>
                        <button onclick="deleteLocation(${location.id})" class="text-red-600">Delete</button>
                    </div>
                </div>
            `).join('');
        }

        // Add new meal
        document.getElementById('mealForm').addEventListener('submit', async (e) => {
            e.preventDefault();
            const data = {
                name: document.getElementById('mealName').value,
                description: document.getElementById('mealDescription').value,
                price: document.getElementById('mealPrice').value,
                image: document.getElementById('mealImage').value
            };

            const response = await fetch('http://localhost:8000/api/meals/', {
                method: 'POST',
                headers: {'Content-Type': 'application/json'},
                body: JSON.stringify(data)
            });

            if (response.ok) {
                fetchMeals();
                e.target.reset();
            }
        });

        // Add new delivery type
        document.getElementById('deliveryTypeForm').addEventListener('submit', async (e) => {
            e.preventDefault();
            const data = {
                name: document.getElementById('deliveryTypeName').value,
                price: document.getElementById('deliveryTypePrice').value
            };

            const response = await fetch('http://localhost:8000/api/delivery-types/', {
                method: 'POST',
                headers: {'Content-Type': 'application/json'},
                body: JSON.stringify(data)
            });

            if (response.ok) {
                fetchDeliveryTypes();
                e.target.reset();
            }
        });

        // Add new location
        document.getElementById('locationForm').addEventListener('submit', async (e) => {
            e.preventDefault();
            const data = {
                name: document.getElementById('locationName').value
            };

            const response = await fetch('http://localhost:8000/api/locations/', {
                method: 'POST',
                headers: {'Content-Type': 'application/json'},
                body: JSON.stringify(data)
            });

            if (response.ok) {
                fetchLocations();
                e.target.reset();
            }
        });

        // Delete functions
        async function deleteMeal(id) {
            if (confirm('Are you sure you want to delete this meal?')) {
                const response = await fetch(`http://localhost:8000/api/meals/${id}/`, {
                    method: 'DELETE'
                });
                if (response.ok) {
                    fetchMeals();
                }
            }
        }

        async function deleteDeliveryType(id) {
            if (confirm('Are you sure you want to delete this delivery type?')) {
                const response = await fetch(`http://localhost:8000/api/delivery-types/${id}/`, {
                    method: 'DELETE'
                });
                if (response.ok) {
                    fetchDeliveryTypes();
                }
            }
        }

        async function deleteLocation(id) {
            if (confirm('Are you sure you want to delete this location?')) {
                const response = await fetch(`http://localhost:8000/api/locations/${id}/`, {
                    method: 'DELETE'
                });
                if (response.ok) {
                    fetchLocations();
                }
            }
        }

        // Edit functions
        async function editMeal(id) {
            const response = await fetch(`http://localhost:8000/api/meals/${id}/`);
            const meal = await response.json();
            
            document.getElementById('mealName').value = meal.name;
            document.getElementById('mealDescription').value = meal.description;
            document.getElementById('mealPrice').value = meal.price;
            document.getElementById('mealImage').value = meal.image;
            
            // Change form submission to update instead of create
            const form = document.getElementById('mealForm');
            form.onsubmit = async (e) => {
                e.preventDefault();
                const data = {
                    name: document.getElementById('mealName').value,
                    description: document.getElementById('mealDescription').value,
                    price: document.getElementById('mealPrice').value,
                    image: document.getElementById('mealImage').value
                };

                const response = await fetch(`http://localhost:8000/api/meals/${id}/`, {
                    method: 'PUT',
                    headers: {'Content-Type': 'application/json'},
                    body: JSON.stringify(data)
                });

                if (response.ok) {
                    fetchMeals();
                    form.reset();
                    form.onsubmit = null; // Reset form submission handler
                }
            };
        }

        async function editDeliveryType(id) {
            const response = await fetch(`http://localhost:8000/api/delivery-types/${id}/`);
            const type = await response.json();
            
            document.getElementById('deliveryTypeName').value = type.name;
            document.getElementById('deliveryTypePrice').value = type.price;
            
            const form = document.getElementById('deliveryTypeForm');
            form.onsubmit = async (e) => {
                e.preventDefault();
                const data = {
                    name: document.getElementById('deliveryTypeName').value,
                    price: document.getElementById('deliveryTypePrice').value
                };

                const response = await fetch(`http://localhost:8000/api/delivery-types/${id}/`, {
                    method: 'PUT',
                    headers: {'Content-Type': 'application/json'},
                    body: JSON.stringify(data)
                });

                if (response.ok) {
                    fetchDeliveryTypes();
                    form.reset();
                    form.onsubmit = null;
                }
            };
        }

        async function editLocation(id) {
            const response = await fetch(`http://localhost:8000/api/locations/${id}/`);
            const location = await response.json();
            
            document.getElementById('locationName').value = location.name;
            
            const form = document.getElementById('locationForm');
            form.onsubmit = async (e) => {
                e.preventDefault();
                const data = {
                    name: document.getElementById('locationName').value
                };

                const response = await fetch(`http://localhost:8000/api/locations/${id}/`, {
                    method: 'PUT',
                    headers: {'Content-Type': 'application/json'},
                    body: JSON.stringify(data)
                });

                if (response.ok) {
                    fetchLocations();
                    form.reset();
                    form.onsubmit = null;
                }
            };
        }

        // Logout function
        async function logout() {
            const response = await fetch('http://localhost:8000/api/auth/logout/', {
                method: 'POST'
            });
            if (response.ok) {
                window.location.href = '/login.html';
            }
        }

        // Load data on page load
        fetchMeals();
        fetchDeliveryTypes();
        fetchLocations();
    </script>
</body>
</html> 